'use strict';function main(){setInterval(function(){$('.bulb-container').toggleClass('lit')},500),soundSprite.init(document.getElementById('audio'),{knock1:{start:0,length:2},knock2:{start:2.5,length:2},open:{start:5,length:1.5},close:{start:7,length:2}}),sequencer.setState('knock'),$('.door').click(function(){sequencer.setState($(this).hasClass('d-open')?'knock':'open')}),$('.popup').click(function(){return $('.payment').slideDown()})}var ball={init:function init(){this.current=localStorage.hw16_lastBall||null},offsets:[[0,-31],[0,-27],[-7,-18],[-3,-34],[-3,-34],[18,-36],[-4,-36],[-6,-36],[-1,-33],[-2,-35],[-8,-21],[-6,-34],[19,-30],[-26,-33],[-1,-34],[1,-31]],placeNew:function placeNew(a){if('number'!=typeof a)for(a=Math.floor(16*Math.random());a==this.current;)a=Math.floor(16*Math.random());var b=this.offsets[a];$('.ball').attr('src','balls/'+a.toString(16)+'.png').show(),injector.inject('ball-offset',['-webkit-','-ms-',''].reduce(function(d,e){return d+(e+'transform: translate('+b[0]+'px, '+b[1]+'px);')},'.ball {')+'}'),this.current=a,localStorage.hw16_lastBall=a},hide:function hide(){$('.ball').hide(),this.current=!1}};ball.init();var sequencer={states:{knock:{start:function start(){var _this2=this;$('.door').removeClass('d-open').addClass('d-closed');var a=function a(){_this2.knockTimeout=setTimeout(function(){soundSprite.play('knock'+_rI(1,2)),ball.placeNew(),a()},_rI(3000,5000))};a()},stop:function stop(){soundSprite.el.pause(),clearTimeout(this.knockTimeout)}},open:{start:function start(){clearTimeout(this.goAwayTimeout),soundSprite.play('open'),$('.door').removeClass('d-closed').addClass('d-open'),$('.ball').is(':visible')&&(this.popup=setTimeout(function(){return $('.popup').removeClass('hidden')},1000))},stop:function stop(){clearTimeout(this.popup),$('.popup').addClass('hidden'),$('.payment').hide(),soundSprite.play('close'),this.goAwayTimeout=setTimeout(function(){return ball.hide()},1500)}}},setState:function setState(a){this.state&&this.states[this.state].stop(),this.states[a].start(),this.state=a}},injector={inject:function inject(a,b){var d='injector:'+a,e=document.getElementById(d);if(e)return void(e.innerHTML=b);var f=document.head||document.getElementsByTagName('head')[0],g=document.createElement('style');g.type='text/css',g.id=d,g.styleSheet?g.styleSheet.cssText=b:g.appendChild(document.createTextNode(b)),f.appendChild(g)},remove:function remove(a){var b='injector:'+a,d=document.getElementById(b);if(d){var e=document.head||document.getElementsByTagName('head')[0];e&&e.removeChild(document.getElementById(b))}}},soundSprite={data:null,current:null,el:null,init:function init(a,b){this.data=b,this.el=a,this.el.volume=0.5;var d=this;this.el.addEventListener('timeupdate',function(){this.currentTime>=d.current.start+d.current.length&&this.pause()},!1)},play:function play(a){var b=this.data[a];b&&b.length&&(this.current=b,this.el.currentTime=b.start,this.el.play())}};function _rI(a,b){return Math.floor(Math.random()*(b-a+1))+a}