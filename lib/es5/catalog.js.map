{"version":3,"sources":["../../babel/src/catalog.js"],"names":["main","$","ajaxSetup","dataType","click","toggleClass","fetchPromises","Promise","resolve","reject","getJSON","Date","getTime","done","catalog","add","data","chans","origin","version","fail","err","localStorage","myDrafts","JSON","parse","myDraftsRaw","_","cloneDeep","e","removeItem","console","error","push","myDraftsValid","forEach","draft","name","url","id","match","originalID","errorBoy","pushError","all","then","list","init","bind","ev","$chev","parent","find","css","stopPropagation","addClass","tab","text","toLowerCase","switchTab","ctab","focus","on","val","trim","length","injector","inject","removeClass","$ch","parents","toggle","_libdata","preventDefault","handleFile","originalEvent","jq","msg","append","escape","vers","versMap","v","versions","stringify","sortable","Sortable","create","document","querySelector","handle","animation","onSort","sync","myList","myListUpdated","actual","chanByID","ich","each","arrayify","chan","prop","buildChan","ballSrc","ball","section","_id","ballv","includes","toArray","remove","res","querySelectorAll","ch","default","makeOffset","insertAfter","log","wiki","conf","search","replace","included","makeGradient","catbg","location","protocol","host","offset","left","top","hov","Math","round","prefix","syncRawDrafts","arr","Array","alias","existing","getElementById","innerHTML","head","getElementsByTagName","style","createElement","type","styleSheet","cssText","appendChild","createTextNode","removeChild","colors","unprefixed","exec","rest","without","gradientDirection","ret","gradientType","isNaN","parseFloat","gradientStops","NodeList","prototype","makeEscapeTagLiteralFn","fn","strings","result","i","reloadFrame","frames","reload","openMenu","window","addEventListener","live","files","dataTransfer","target","f","reader","FileReader","onload","imported","readAsText","info"],"mappings":"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","file":"catalog.js","sourcesContent":["\"use strict\";\n\nconst main = () => {\n\t$.ajaxSetup({\n\t\tdataType: 'json'\n\t})\n\n\t$('#drawer, #hijab').click(() => $('body').toggleClass('list-collapsed'))\n\n\tlet fetchPromises = [new Promise((resolve, reject) => {\n\t\t$.getJSON(`/chans/chans.json?v=${new Date().getTime()}`)\n\t\t.done(data => {\n\t\t\tcatalog.add(data.chans)\n\t\t\tresolve({\n\t\t\t\torigin: 'server',\n\t\t\t\tversion: data.version\n\t\t\t})\n\t\t})\n\t\t.fail(err => reject(err))\n\t})]\n\tif (localStorage['mydrafts']) {\n\t\tlet myDrafts = null\n\t\ttry {\n\t\t\tmyDrafts = JSON.parse(localStorage['mydrafts'])\n\t\t\tcatalog.myDraftsRaw = _.cloneDeep(myDrafts.chans)\n\t\t}\n\t\tcatch(e) {\n\t\t\tlocalStorage.removeItem('mydrafts')\n\t\t\tconsole.error(e)\n\t\t}\n\t\tif (myDrafts.chans) {\n\t\t\tfetchPromises.push(new Promise((resolve, reject) => {\n\t\t\t\tlet myDraftsValid = []\n\t\t\t\tmyDrafts.chans.forEach(draft => {\n\t\t\t\t\tif (draft.name && draft.url && draft.id && draft.id.match(/^[a-z\\-_0-9]+$/)) {\n\t\t\t\t\t\tdraft.originalID = draft.id\n\t\t\t\t\t\tdraft.id += `!draft`\n\t\t\t\t\t\tmyDraftsValid.push(draft)\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\terrorBoy.pushError(`Черновик #${draft.id} не добавлен в каталог: недостаточно данных или некорректный ID.`)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\tcatalog.add(myDraftsValid, 'drafts')\n\t\t\t\tresolve({\n\t\t\t\t\torigin: 'drafts',\n\t\t\t\t\tversion: myDrafts.version\n\t\t\t\t})\n\t\t\t}))\n\t\t}\n\t}\n\tPromise.all(fetchPromises).then(list.init.bind(list), err => console.error(err))\n\n\t$('.tab').click(function(ev) {\n\t\tlet $chev = $(this).parent().find('.icon')\n\t\tif ($chev.css('display') === 'block' && $chev.css('opacity') == 1) {\n\t\t\tev.stopPropagation()\n\t\t\t$('#catalog header').addClass('tab-selecting')\n\t\t}\n\t\telse {\n\t\t\tlet tab = $(this).text().toLowerCase()\n\t\t\tswitchTab(tab)\n\t\t}\n\t})\n\n\tlet ctab = localStorage['cat-tab']\n\tif (ctab) {\n\t\tswitchTab(ctab)\n\t}\n\n\t$('#toggle-search').click(function() {\n\t\t$('#catalog').addClass('searching')\n\t\t$('#search').focus()\n\t})\n\t$('#search').on('input', function() {\n\t\tlet val = $(this).val().trim().toLowerCase()\n\t\t$('#catalog').toggleClass('search-filter', !!val.length)\n\t\tinjector.inject('cat-search', `.search-filter .cat-chan[data-search *= \"${val}\"] {display: inline-block}`)\n\t})\n\t$('#cancel-search').click(function() {\n\t\t$('#catalog').removeClass('searching search-filter')\n\t\t$('#search').val('')\n\t})\n\n\t$('body')\n\t.click(() => $('#catalog header').removeClass('tab-selecting'))\n\t.on('click', '.cc-install', function() {\n\t\tlet $ch = $(this).parents('.cat-chan')\n\t\tlist.toggle($ch[0]._libdata)\n\t})\n\t.on('click', '.make-embed', function() {\n\t\t$(this).parents('.cat-chan').toggleClass('code-on')\n\t})\n\t.on('dragenter dragend dragover drop dragleave', function(ev) {\n\t\tev.preventDefault()\n\t\tev.stopPropagation()\n\t})\n\t.on('drop', ev => handleFile(ev.originalEvent))\n\n\t$('#up-victim').on('change', ev => handleFile(ev.originalEvent))\n\t$('#import-draft').click(() => $('#up-victim').click())\n}\n\nfunction switchTab(tab) {\n\t$('.tab').removeClass('tab-selected')\n\t$(jq`#tab-${tab}`).addClass('tab-selected')\n\t$('#catalog').removeClass('tab-default tab-custom tab-drafts').addClass(`tab-${tab}`)\n\tlocalStorage['cat-tab'] = tab\n}\n\n/*function displayErrorToggle(text) {\n\t$('#errmsgbox').fadeToggle('fast').find('.error-message').text(text || '')\n}*/\n\nvar errorBoy = {\n\tpushError: function(msg) {\n\t\t$('#error-wrapper').append(html`<div class=\"errmsgbox\" onclick=\"this.remove()\">\n\t\t\t<svg id=\"close-errmsg\" class=\"icon\"><use xlink:href=\"#i-x\"></use></svg>\n\t\t\t<p class=\"error-message\">${_.escape(msg)}</p>\n\t\t</div>`)\n\t}\n}\n\nvar list = {\n\tinit: function(vers) {\n\t\tlet versMap = {}\n\t\tvers.forEach(v => versMap[v.origin] = v.origin)\n\t\tthis.versions = versMap\n\t\tlocalStorage['catalogVersions'] = JSON.stringify(versMap)\n\n\t\tthis.sortable = Sortable.create(document.querySelector('#boardlist'), {\n\t\t\thandle: '.dragger',\n\t\t\tanimation: 150,\n\t\t\tonSort: this.sync.bind(this)\n\t\t})\n\t\t\n\t\tlet myList = localStorage['myChans_new']\n\t\t, myListUpdated = []\n\t\tif (myList) {\n\t\t\ttry {\n\t\t\t\tmyList = JSON.parse(myList)\n\t\t\t}\n\t\t\tcatch(e) {\n\t\t\t\tconsole.error(e)\n\t\t\t\tlocalStorage.removeItem('myChans_new')\n\t\t\t\tmyList = null\n\t\t\t}\n\t\t\tif (myList && myList.length) {\n\t\t\t\tmyList.forEach(ich => {\n\t\t\t\t\tlet actual = catalog.chanByID(ich.id)\n\t\t\t\t\tif (actual) {\n\t\t\t\t\t\tmyListUpdated.push(actual)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t\tif (!myList) {\n\t\t\t$('.included-chan').each(function() {\n\t\t\t\tmyListUpdated.push(this._libdata)\n\t\t\t})\n\t\t}\n\t\tthis.add(myListUpdated)\n\t},\n\tadd: function(chans) {\n\t\tarrayify(chans).forEach(chan => {\n\t\t\t['catbg', 'offset'/*, 'included'*/].forEach(prop => delete chan[prop])\n\t\t\tlet $ch = $(this.buildChan(chan))\n\t\t\t$ch[0]._libdata = chan\n\t\t\t$('#boardlist').append($ch)\n\t\t\t$(jq`#cat_${chan.id}`).addClass('installed')\n\t\t})\n\t\tthis.sync()\n\t},\n\tbuildChan: function(chan) {\n\t\tlet name = _.escape(chan.name)\n\t\t, ballSrc = chan.ball || html`/chans/balls/${chan.section}/${chan.section == 'drafts' ? 'no-ball' : chan.id}.png?uid=${chan._id}${chan.ballv ? `&v=${chan.ballv}` : ''}`\n\t\treturn html`<li class=\"list-chan\" id=\"installed_${chan.id}\" data-id=\"${chan.id}\">\n\t\t\t<img src=\"${ballSrc}\" class=\"list-chanball\">\n\t\t\t<div class=\"dragger\"><svg class=\"icon\"><use xlink:href=\"#i-drag\"></use></div>\n\t\t\t<div class=\"list-chan-title\">${name || 'Без имени'}</div>\n\t\t\t<div class=\"delete-chan\" onclick=\"javascript:list.remove('${chan.id}')\"><svg class=\"icon\"><use xlink:href=\"#i-x\"></use></div>\n\t\t</li>`\n\t},\n\ttoggle: function(chan) {\n\t\tif (_.includes(this.sortable.toArray(), chan.id)) {\n\t\t\tthis.remove(chan.id)\n\t\t}\n\t\telse {\n\t\t\tthis.add(chan)\n\t\t}\n\t},\n\tremove: function(id) {\n\t\t$(jq`#installed_${id}`).remove()\n\t\t$(jq`#cat_${id}`).removeClass('installed')\n\t\tthis.sync()\n\t},\n\tsync: function() {\n\t\tlet res = []\n\t\tdocument.querySelectorAll('.list-chan').forEach(ch => {\n\t\t\tres.push(ch._libdata)\n\t\t})\n\t\tlocalStorage.removeItem('compiledCSS')\n\t\tlocalStorage['myChans_new'] = JSON.stringify(res)\n\t}\n}\n\nvar catalog = {\n\tadd: function(chans, section) {\n\t\tarrayify(chans).forEach(chan => {\n\t\t\tif (!chan.section) {\n\t\t\t\tchan.section = section || (chan.default ? 'default' : 'custom')\n\t\t\t}\n\t\t\tchan.url = _.escape(chan.url)\n\t\t\tlet $ch = $(this.buildChan(chan))\n\t\t\t$ch[0]._libdata = chan\n\t\t\t$('#catalog-contents').append($ch)\n\t\t\tthis.css += this.makeOffset(chan)\n\t\t})\n\t\t$('#import-draft').insertAfter('.cat-chan:last')\n\t\tinjector.inject('chan-offsets', this.css)\n\t},\n\tbuildChan: function(chan) {\n\t\tconsole.log(chan.id)\n\t\tlet name = _.escape(chan.name)\n\t\t, wiki = (chan.wiki && chan.wiki.match(/https?:\\/\\//)) ? chan.wiki : (conf.wiki+(chan.wiki || name))\n\t\t, search = `${chan.originalID || chan.id} ${name} ${chan.url.replace(/^https?:\\/\\//, '')} ${(chan.wiki || '').replace(/^https?:\\/\\//, '')}`\n\t\t, ballSrc = chan.ball || `/chans/balls/${chan.section}/${chan.section == 'drafts' ? 'no-ball' : chan.id}.png?uid=${chan._id}${chan.ballv ? `&v=${chan.ballv}` : ''}`\n\t\treturn html`<div class=\"cat-chan sect-${chan.section} ${chan.included ? 'included-chan' : ''}\" data-search=\"${search.toLowerCase()}\" id=\"cat_${chan.id}\">\n\t\t\t<div class=\"cc-ball-wrap\" style=\"${makeGradient(chan.catbg)}\">\n\t\t\t\t<img src=\"${ballSrc}\" class=\"cc-ball\"></img>\n\t\t\t\t<div class=\"channame-overlay\">\n\t\t\t\t\t<a href=\"${chan.url}\">${name}</a>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"cc-toolbar\">\n\t\t\t\t<button class=\"cc-install\">\n\t\t\t\t\t<span class=\"cci-i\">Добавить</span>\n\t\t\t\t\t<span class=\"cci-u\">Удалить</span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<div class=\"chan-options make-embed\" title=\"Код для кнопки\">\n\t\t\t\t<svg class=\"icon\">\n\t\t\t\t\t<use class=\"co-code\" xlink:href=\"#i-code\"></use>\n\t\t\t\t\t<use class=\"co-close\" xlink:href=\"#i-x\"></use>\n\t\t\t\t</svg>\n\t\t\t</div>\n\t\t\t<a class=\"chan-options info-link\" target=\"_blank\" href=\"${wiki}\" title=\"Информация\">\n\t\t\t\t<svg class=\"icon\"><use xlink:href=\"#i-info\"></use></svg>\n\t\t\t</a>\n\t\t\t<textarea onclick=\"this.select()\">${_.escape(`<script src=\"${document.location.origin || (document.location.protocol + '//' + document.location.host)}/embed/add.js\" chan=\"${chan.id}\"></script>`)}</textarea>\n\t\t</div>`\n\t},\n\tcss: '',\n\tmakeOffset: function(chan) {\n\t\tif (! chan.offset)\n\t\t\treturn '';\n\t\tlet left = chan.offset[0], top = chan.offset[1]\n\t\t, res = '', hov = ''\n\t\tif (left == 0 && top == 0)\n\t\t\treturn '';\n\t\t;['', '-webkit-', '-ms-', '-moz-', '-o-'].forEach(prefix => {\n\t\t\tres += `${prefix}transform: translate(${left}px, ${top}px) scale(1); `\n\t\t\thov += `${prefix}transform: translate(${Math.round(left * 0.66)}px, ${Math.round(top * 0.66)}px) scale(0.66); `\n\t\t})\n\t\treturn `#cat_${chan.id.replace(/\\!/g, '\\\\!')} .cc-ball {${res}}\n\t\t\t#cat_${chan.id.replace(/\\!/g, '\\\\!')}:hover .cc-ball {${hov}}`\n\t},\n\tchanByID: id => {\n\t\tlet ch = document.querySelector(jq`#cat_${id}`)\n\t\tif (ch && ch._libdata) {\n\t\t\treturn ch._libdata\n\t\t}\n\t\telse return null\n\t},\n\tmyDraftsRaw: [],\n\tsyncRawDrafts: function() {\n\t\tlocalStorage['mydrafts'] = JSON.stringify({\n\t\t\tversion: new Date().getTime(),\n\t\t\tchans: this.myDraftsRaw\n\t\t})\n\t}\n}\n\nfunction arrayify(arr) {\n\treturn (arr instanceof Array) ? arr : [arr]\n}\n\nvar injector = {\n\tinject: function(alias, css) {\n\t\tvar id = `injector:${alias}`\n\t\tvar existing = document.getElementById(id)\n\t\tif (existing) {\n\t\t\texisting.innerHTML = css\n\t\t\treturn\n\t\t}\n\t\tvar head = document.head || document.getElementsByTagName('head')[0]\n\t\t, style = document.createElement('style');\n\t\tstyle.type = 'text/css'\n\t\tstyle.id = id\n\t\tif (style.styleSheet) {\n\t\t\tstyle.styleSheet.cssText = css\n\t\t} else {\n\t\t\tstyle.appendChild(document.createTextNode(css))\n\t\t}\n\t\thead.appendChild(style)\n\t},\n\tremove: function(alias) {\n\t\tvar id = `injector:${alias}`\n\t\tvar style = document.getElementById(id)\n\t\tif (style) {\n\t\t\tvar head = document.head || document.getElementsByTagName('head')[0]\n\t\t\tif (head)\n\t\t\t\thead.removeChild(document.getElementById(id))\n\t\t}\n\t}\n}\n\nfunction makeGradient(colors) {\n\tlet unprefixed = `linear-gradient(to bottom, #${colors[0]} 0%, #${colors[1]} 100%)`\n\t, res = /(((?:radial|linear)-gradient)\\((?:(ellipse) at center|(-?[0-9]+)deg|to (right|bottom)), ?(.+)\\));?/i.exec(unprefixed);\n\tif (res === null) return 'background:' + unprefixed;\n\tres = _.rest(_.without(res, undefined));\n\tvar ret = res[0]+'; ';\n\tvar gradientType = res[1];\n\tvar gradientDirection;\n\tif (!isNaN(res[2])) gradientDirection = (90 - parseFloat(res[2])) + 'deg, ';\n\telse if (res[2] == 'bottom') gradientDirection = 'top, ';\n\telse if (res[2] == 'right') gradientDirection = 'left, ';\n\telse gradientDirection = 'center, ellipse cover, ';\n\tvar gradientStops = res[3];\n\t_.each(['-o-', '-webkit-', '-moz-'], function(prefix) {\n\t\tret += 'background:' + prefix + gradientType + '(' + gradientDirection + gradientStops + '); ';\n\t});\n\treturn 'background:' + ret;\n}\n\n\nNodeList.prototype.forEach = Array.prototype.forEach;\n\n// Produces a function which applies fn() to all values\nfunction makeEscapeTagLiteralFn(fn = v => v) {\n  return function(strings, ...values) {\n    let result = \"\"\n    for (let i = 0; i < strings.length; i++) {\n      result += strings[i]\n      if (i < values.length) {\n        result += fn(''+values[i])\n      }\n    }\n    return result\n  }\n}\n// Escape tag literal functions for jQuery queries and regular expressions\nvar jq = makeEscapeTagLiteralFn(v => v.replace(/([!\"#$%&'()*+,\\-./:;<=>?@[\\\\\\]^`{|}~ ])/g, \"\\\\$1\"))\n\nvar conf = {\n\twiki: 'http://wiki.1chan.ca/'\n}\n\nfunction reloadFrame() {\n\tparent.frames.list.document.location.reload()\n\tparent.openMenu()\n}\n\nwindow.addEventListener(\"message\", () => {\n\tparent.frames.live.document.location.reload()\n}, false)\n\nfunction handleFile(ev) {\n\tlet files = (ev.type == \"drop\") ? ev.dataTransfer.files : ev.target.files\n\t, f = files[0]\n\n\tif (f) {\n\t\tvar reader = new FileReader()\n\t\t\n\t\treader.onload = (function() {\n\t\t\treturn (function(e) {\n\t\t\t\tlet imported = null\n\t\t\t\ttry {\n\t\t\t\t\timported = JSON.parse(e.target.result)\n\t\t\t\t}\n\t\t\t\tcatch(err) {\n\t\t\t\t\terrorBoy.pushError('Не удалось разобрать JSON')\n\t\t\t\t}\n\t\t\t\tif (imported) {\n\t\t\t\t\tif (!(imported.name && imported.url && imported.id && imported.id.match(/^[a-z\\-_0-9]+$/))) {\n\t\t\t\t\t\terrorBoy.pushError('Невозможно добавить черновик. Недостаточно данных.')\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\tif (_.find(catalog.myDraftsRaw, {id: imported.id})) {\n\t\t\t\t\t\terrorBoy.pushError('Черновик с таким id уже существует')\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\tcatalog.myDraftsRaw.push(_.cloneDeep(imported))\n\t\t\t\t\tcatalog.syncRawDrafts()\n\t\t\t\t\timported.id += `!draft`\n\t\t\t\t\tcatalog.add(imported, 'drafts')\n\t\t\t\t}\n\t\t\t}).bind(this)\n\t\t}).bind(this)(f)\n\n\t\treader.readAsText(f)\n\t}\n}\n\nconsole.info('Я не на ангуляре. Не на ангуляре.')"]}